<section class="section shop" id="shop" aria-label="shop" data-section>
  <div class="title-wrapper recommended-title">
      <h2 class="h2 section-title"><%= title %></h2>

      <a href="#" class="btn-link">
        <span class="span">Shop All Products</span>

        <ion-icon name="arrow-forward" aria-hidden="true"></ion-icon>
      </a>
    </div>

  <div class="collections_container" data-section>
    <% products.forEach(product => { %>
      <li class="scrollbar-item">
        <div class="shop-card">

          <div class="card-banner img-holder" style="--width: 540; --height: 720;">
            <img src="<%= product.image %>" width="540" height="720" loading="lazy"
              alt="<%= product.name %>" class="img-cover">

            <% if(product.discount) { %>
              <span class="badge" aria-label="<%= product.discount %>% off">-<%= product.discount %>%</span>
            <% } %>

            <div class="card-actions">

              <button class="action-btn" aria-label="add to cart">
                <ion-icon name="bag-handle-outline" aria-hidden="true"></ion-icon>
              </button>

              <button class="action-btn" aria-label="add to wishlist">
                <ion-icon name="star-outline" aria-hidden="true"></ion-icon>
              </button>

              <button class="action-btn" aria-label="compare">
                <ion-icon name="repeat-outline" aria-hidden="true"></ion-icon>
              </button>

            </div>
          </div>

          <div class="card-content">

            <div class="price">
              <% if(product.oldPrice) { %>
                <del class="del">$<%= product.oldPrice.toFixed(2) %></del>
              <% } %>

              <span class="span">$<%= product.price.toFixed(2) %></span>
            </div>

            <h3>
              <a href="/product/<%= product.id %>" class="card-title"><%= product.name %></a>
            </h3>

            <div class="card-rating">

              <div class="rating-wrapper" aria-label="<%= product.rating %> star rating">
                <% 
                  let fullStars = Math.floor(product.rating);
                  let halfStar = (product.rating % 1) >= 0.5;
                  let emptyStars = 5 - fullStars - (halfStar ? 1 : 0);
                  
                  for(let i = 0; i < fullStars; i++) { %>
                    <ion-icon name="star" aria-hidden="true"></ion-icon>
                <% } %>
                <% if(halfStar) { %>
                  <ion-icon name="star-half-outline" aria-hidden="true"></ion-icon>
                <% } %>
                <% for(let i = 0; i < emptyStars; i++) { %>
                  <ion-icon name="star-outline" aria-hidden="true"></ion-icon>
                <% } %>
              </div>

              <p class="rating-text"><%= product.reviews %> reviews</p>

            </div>

          </div>

        </div>
      </li>
    <% }); %>
  </div>
</section>
